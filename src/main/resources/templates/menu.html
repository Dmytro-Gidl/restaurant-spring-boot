<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8"/>
    <title>Menu</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css"
          rel="stylesheet"
          integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3"
          crossorigin="anonymous">

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"
            integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p"
            crossorigin="anonymous"></script>
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.15.4/css/all.css" crossorigin="anonymous">
    <link rel="stylesheet" type="text/css" href="/css/style-menu.css"/>

</head>
<body>
<div th:replace="fragments/topnav :: navbar"></div>

<!-- TITLE -->
<div class="wrapper">
    <div class="title">
        <span th:text="#{menu.tagline}" class="slogan">Good food and great vibes</span>
        <h4 th:text="#{menu.headline}">Our Menu</h4>
    </div>

    <!--SORT AND FILTER-->
    <div class="filter-menu d-flex justify-content-end mb-4 flex-column">
        <div class="filter-menu-desc text-center">
            <p th:text="#{menu.sort}" class="m-0 fs-4">Sort by and Filter</p>
        </div>
        <div class="btn-group mb-3" role="group" aria-label="Button group with nested dropdown">
            <a th:text="#{menu.sort.name}"
               th:href="@{'/menu?sortField=name&sortDir=' + ${reverseSortDir} + '&filterCategory=' + ${filterCategory}}"
               class="btn btn-outline-light mt-3 btn-lg">Name</a>
            <a th:text="#{menu.sort.price}"
               th:href="@{'/menu?sortField=price&sortDir=' + ${reverseSortDir} + '&filterCategory=' + ${filterCategory}}"
               class="btn btn-outline-light mt-3 btn-lg">Price</a>
            <a th:text="#{menu.sort.category}"
               th:href="@{'/menu?sortField=category&sortDir=' + ${reverseSortDir} + '&filterCategory=' + ${filterCategory}}"
               class="btn btn-outline-light mt-3 btn-lg">Category</a>

            <div class="btn-group" role="group">
                <button th:text="#{menu.filter.category}" id="btnGroupDrop1" type="button"
                        class="btn btn-outline-light mt-3 btn-lg dropdown-toggle"
                        data-bs-toggle="dropdown" aria-expanded="false">
                    Choose Category
                </button>
                <ul class="dropdown-menu" aria-labelledby="btnGroupDrop1">
                    <li>
                        <a th:text="#{menu.filter.category.all}"
                           th:href="@{'/menu?sortField=' + ${sortField} + '&sortDir=' + ${reverseSortDir} + '&filterCategory=all'}"
                           class="dropdown-item">Show all</a>
                    </li>
                    <li>
                        <a th:href="@{'/menu?sortField=' + ${sortField} + '&sortDir=' + ${reverseSortDir} + '&filterCategory=drinks'}"
                           class="dropdown-item">Drinks</a>
                    </li>
                    <li>
                        <a th:href="@{'/menu?sortField=' + ${sortField} + '&sortDir=' + ${reverseSortDir} + '&filterCategory=burgers'}"
                           class="dropdown-item">Burgers</a>
                    </li>
                    <li>
                        <a th:href="@{'/menu?sortField=' + ${sortField} + '&sortDir=' + ${reverseSortDir} + '&filterCategory=snacks'}"
                           class="dropdown-item">Snacks</a>
                    </li>
                </ul>
            </div>
        </div>
    </div>

    <!--MENU-->
    <div th:if="${dishList.size() > 0}">
        <form onsubmit="clearLocalStorage()"
              th:action="@{/orders}"
              th:object="${orderCreationDto}"
              method="post">

            <div class="menu">
                <div th:each="dish : ${dishList}">
                    <div th:replace="fragments/dishCard :: dishCard(dish=${dish})"></div>
                </div>
            </div>

            <!-- Original sum display (optional) -->
            <span th:text="#{menu.total.sum}"
                  class="h4 text-uppercase font-weight-bold mb-4">Total sum:</span>
            <span class="h2 font-weight-bold total-price">0</span>
            <span class="h4 currency">₴</span>

            <!-- Address input removed: users provide address on the checkout page -->
        </form>
    </div>
</div>

<!-- If no dishes exist -->
<div th:unless="${dishList.size() != 0}" class="text-center">
    <p th:text="#{the.category.empty}" class="display-2 text-white">Menu is in development.</p>
    <p th:text="#{choose.another}" class="display-2 text-white">Choose another one or come back later.</p>
    <p class="display-2 text-white">:(</p>
</div>

<!-- BOTTOM-RIGHT PINNED CART -->
<div id="bottom-right-cart">
    <h5>Your Order</h5>
    <div id="cart-items-list"></div>
    <div class="cart-total-line">
        Total: <span id="bottomCartTotal">0</span> ₴
    </div>
    <button class="checkout-btn" onclick="proceedToCheckout()">Checkout</button>
</div>

<script>
    function proceedToCheckout() {
        window.location.href = '/orders/checkout';
    }
</script>

<script type="text/javascript" th:src="@{/js/button.js}"></script>
</body>
</html>
